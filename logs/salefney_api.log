[2025-11-07 19:47:54,686] INFO in index: Starting Salefney API server...
[2025-11-07 19:48:19,832] INFO in index: Received registration request
[2025-11-07 19:48:19,832] INFO in index: Processing registration data
[2025-11-07 19:48:22,767] WARNING in index: Registration failed: Username username already exists
[2025-11-07 19:48:32,562] INFO in index: Received request to get predictions
[2025-11-07 19:49:04,756] INFO in index: Starting Salefney API server...
[2025-11-07 19:49:15,455] INFO in index: Received login request
[2025-11-07 19:49:15,456] INFO in index: Processing login data
[2025-11-07 19:49:18,144] INFO in index: User found: user@example.com
[2025-11-07 19:49:31,765] INFO in index: Received request to get predictions
[2025-11-07 19:49:33,302] INFO in index: Received request to get predictions
[2025-11-07 19:49:33,734] INFO in index: Received request to get predictions
[2025-11-07 19:49:33,928] INFO in index: Received request to get predictions
[2025-11-07 19:50:25,810] INFO in index: Starting Salefney API server...
[2025-11-07 19:50:37,633] INFO in index: Starting Salefney API server...
[2025-11-07 19:50:37,737] INFO in index: Received request to get predictions
[2025-11-07 19:50:37,739] INFO in index: Checking authentication for user-specific predictions
[2025-11-07 19:50:37,739] INFO in index: Verifying JWT token
[2025-11-07 19:50:37,740] INFO in index: Successfully authenticated user: user@example.com
[2025-11-07 19:50:40,287] ERROR in index: Authentication failed with unexpected error: 400 The query requires an index. You can create it here: https://console.firebase.google.com/v1/r/project/salefney-shokran/firestore/indexes?create_composite=ClRwcm9qZWN0cy9zYWxlZm5leS1zaG9rcmFuL2RhdGFiYXNlcy8oZGVmYXVsdCkvY29sbGVjdGlvbkdyb3Vwcy9wcmVkaWN0aW9ucy9pbmRleGVzL18QARoLCgd1c2VyX2lkEAEaDQoJdGltZXN0YW1wEAIaDAoIX19uYW1lX18QAg
Traceback (most recent call last):
  File "C:\Users\Mosta\salefney-shokran-api\api\index.py", line 490, in get_predictions
    docs = query.get()
           ^^^^^^^^^^^
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\cloud\firestore_v1\query.py", line 202, in get
    result_list = list(result)
                  ^^^^^^^^^^^^
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\cloud\firestore_v1\stream_generator.py", line 58, in __next__
    return self._generator.__next__()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\cloud\firestore_v1\query.py", line 410, in _make_stream
    response_iterator, expected_prefix = self._get_stream_iterator(
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\cloud\firestore_v1\query.py", line 260, in _get_stream_iterator
    response_iterator = self._client._firestore_api.run_query(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\cloud\firestore_v1\services\firestore\client.py", line 1624, in run_query
    response = rpc(
               ^^^^
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Mosta\salefney-shokran-api\.venv\Lib\site-packages\google\api_core\grpc_helpers.py", line 173, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.FailedPrecondition: 400 The query requires an index. You can create it here: https://console.firebase.google.com/v1/r/project/salefney-shokran/firestore/indexes?create_composite=ClRwcm9qZWN0cy9zYWxlZm5leS1zaG9rcmFuL2RhdGFiYXNlcy8oZGVmYXVsdCkvY29sbGVjdGlvbkdyb3Vwcy9wcmVkaWN0aW9ucy9pbmRleGVzL18QARoLCgd1c2VyX2lkEAEaDQoJdGltZXN0YW1wEAIaDAoIX19uYW1lX18QAg
[2025-11-07 19:50:58,596] INFO in index: Starting Salefney API server...
[2025-11-07 19:51:14,323] INFO in index: Starting Salefney API server...
[2025-11-07 19:51:26,803] INFO in index: Starting Salefney API server...
[2025-11-07 19:51:40,339] INFO in index: Starting Salefney API server...
[2025-11-07 19:51:57,065] INFO in index: Starting Salefney API server...
[2025-11-07 19:52:19,047] INFO in index: Received request to get predictions
[2025-11-07 19:52:19,048] INFO in index: Checking authentication for user-specific predictions
[2025-11-07 19:52:19,049] INFO in index: Verifying JWT token
[2025-11-07 19:52:19,050] INFO in index: Successfully authenticated user: user@example.com
[2025-11-07 19:52:22,185] INFO in index: Successfully retrieved 0 predictions for user
[2025-11-07 19:52:51,901] INFO in index: Received prediction request
[2025-11-07 19:52:51,901] INFO in index: Building feature row for prediction
[2025-11-07 19:52:51,921] INFO in index: Saving prediction to Firestore
[2025-11-07 19:52:52,580] INFO in index: Prediction saved successfully
[2025-11-07 19:52:58,899] INFO in index: Received request to get predictions
[2025-11-07 19:52:58,899] INFO in index: Checking authentication for user-specific predictions
[2025-11-07 19:52:58,900] INFO in index: Verifying JWT token
[2025-11-07 19:52:58,900] INFO in index: Successfully authenticated user: user@example.com
[2025-11-07 19:52:59,250] INFO in index: Successfully retrieved 1 predictions for user
